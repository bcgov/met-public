name: LOCUST CI

on:
    pull_request:
        paths:
            - "openshift/locust/**"
    push:
        branches:
            - main
        paths:
            - "openshift/locust/**"

defaults:
    run:
        shell: bash

jobs:
    setup-job:
        runs-on: ubuntu-24.04

        if: github.repository == 'bcgov/met-public'

        steps:
            - uses: actions/checkout@v6
            - run: "true"

    linting:
        needs: setup-job
        runs-on: ubuntu-24.04

        strategy:
            matrix:
                python-version: [3.12]

        steps:
            - uses: actions/checkout@v6
            - name: Set up Python ${{ matrix.python-version }}
              uses: actions/setup-python@v6
              with:
                  python-version: ${{ matrix.python-version }}
            - name: Lint for syntax errors (py_compile)
              run: |
                  python -m py_compile openshift/locust/behaviour/locustfile.py \
                    && echo "No syntax errors found in locustfile.py"
